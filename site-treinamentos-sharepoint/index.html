<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Portal de Treinamentos</title>
<style>
  :root{
    --roxo-header: #6b2fbf;
    --roxo-escuro: #51238f;
    --roxo-claro: #ede7ff;
    --roxo-chip: #f3e9ff;
    --texto-principal: #1f2933;
    --texto-sec: #6b7280;
    --borda: #e5e7eb;
    --bg: #f6f5fb;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, Arial, sans-serif;
    background:var(--bg);
    color:var(--texto-principal);
  }

  /* HEADER */
  .top-bar{
    background: linear-gradient(90deg, var(--roxo-header), var(--roxo-escuro));
    color:#fff;
    padding:14px 26px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
  }
  .top-title{
    font-size:20px;
    font-weight:600;
    margin:0;
  }
  .top-sub{
    margin:2px 0 0 0;
    font-size:12px;
    opacity:.9;
  }
  .logo-rumo{
    height:40px;
    max-width:140px;
    object-fit:contain;
  }

  .wrap{
    max-width:1300px;
    margin:0 auto;
    padding:18px 20px 28px 20px;
  }

  /* FILTROS */
  .filtros-box{
    background:#fff;
    border-radius:16px;
    border:1px solid var(--borda);
    padding:12px 14px 14px 14px;
    box-shadow:0 2px 8px rgba(15,23,42,.05);
    margin-bottom:16px;
  }
  .filtros-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    margin-bottom:6px;
  }
  .filtros-titulo{
    font-size:13px;
    font-weight:600;
    color:var(--texto-sec);
    margin:0;
    display:flex;
    align-items:center;
    gap:6px;
  }
  .filtros-titulo span.icon{
    width:18px; height:18px; border-radius:999px;
    background:var(--roxo-claro);
    display:flex; align-items:center; justify-content:center;
    font-size:11px;
  }
  .btn-clear{
    border:1px solid #e5e7eb;
    background:#fff;
    color:#6b21a8;
    font-size:11px;
    font-weight:600;
    padding:4px 10px;
    border-radius:999px;
    cursor:pointer;
    display:flex;
    align-items:center;
    gap:4px;
  }
  .btn-clear:hover{ background:#f9fafb; }

  .filtros-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
    gap:8px 10px;
  }
  .filtro-label{
    font-size:11px;
    color:var(--texto-sec);
    margin-bottom:2px;
  }
  .filtros-grid input,
  .filtros-grid select{
    width:100%;
    padding:6px 8px;
    border-radius:8px;
    border:1px solid var(--borda);
    font-size:13px;
    color:var(--texto-principal);
    background:#fff;
  }
  .filtros-grid input::placeholder{
    color:#9ca3af;
    font-size:12px;
  }

  /* LISTA DE CARDS */
  #mural{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:14px;
  }
  .card{
    background:#fff;
    border-radius:16px;
    border:1px solid #e5e7eb;
    padding:12px 12px;
    display:flex;
    gap:10px;
    position:relative;
    box-shadow:0 2px 8px rgba(15,23,42,.04);
  }
  .card-hoje{
    border-color:#f97316;
    box-shadow:0 0 0 2px rgba(249,115,22,.25);
  }
  .pill-hoje{
    position:absolute;
    top:8px; right:8px;
    background:#fff7ed;
    color:#c2410c;
    border-radius:999px;
    border:1px solid #fed7aa;
    padding:2px 8px;
    font-size:10px;
    font-weight:600;
  }
  .card img{
    width:72px; height:72px;
    border-radius:50%;
    object-fit:cover;
    border:2px solid var(--roxo-claro);
    flex-shrink:0;
    background:#f3f4f6;
  }
  .info{ flex:1; min-width:0; }
  .linha-top{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:6px;
  }
  .nome{
    margin:0;
    font-size:14px;
    font-weight:600;
    color:var(--texto-principal);
  }
  .cs-tag{
    font-size:11px;
    color:#6b21a8;
    background:var(--roxo-chip);
    border-radius:999px;
    padding:1px 8px;
    border:1px solid #e9d5ff;
    white-space:nowrap;
  }
  .linha-sub{
    margin:2px 0 0 0;
    font-size:11px;
    color:var(--texto-sec);
  }
  .treino{
    margin:6px 0 0 0;
    font-size:12px;
    color:var(--roxo-escuro);
    font-weight:500;
  }
  .datas{
    margin:4px 0 0 0;
    font-size:11px;
    color:#4b5563;
  }

  .status-badge{
    display:inline-block;
    margin-top:6px;
    font-size:10px;
    padding:3px 9px;
    border-radius:999px;
    border:1px solid transparent;
    font-weight:600;
  }
  .st-valido{ background:#ecfdf3; color:#15803d; border-color:#bbf7d0; }
  .st-a-vencer{ background:#fefce8; color:#854d0e; border-color:#fef08a; }
  .st-vencido{ background:#fef2f2; color:#b91c1c; border-color:#fecaca; }
  .st-nao-concluido{ background:#eff6ff; color:#1d4ed8; border-color:#bfdbfe; }
  .st-teste{ background:#f3f4f6; color:#374151; border-color:#e5e7eb; }

  .empty{
    margin-top:12px;
    font-size:13px;
    color:var(--texto-sec);
  }

  @media (max-width:640px){
    .top-bar{padding:12px 16px}
    .wrap{padding-inline:14px}
    .logo-rumo{height:30px;}
  }
</style>
</head>
<body>

  <header class="top-bar">
    <div>
      <h1 class="top-title">Treinamentos ‚Äì Tecnologia Rumo</h1>
      <p class="top-sub">
        Visualize os treinamentos por colaborador, coordena√ß√£o, status e datas de forma√ß√£o e vencimento.
      </p>
    </div>
    <img id="logoRumo" class="logo-rumo" alt="Rumo">
  </header>

  <main class="wrap">

    <section class="filtros-box">
      <div class="filtros-header">
        <p class="filtros-titulo">
          <span class="icon">üîç</span>
          Filtros por coluna
        </p>
        <button type="button" id="btnLimpar" class="btn-clear">‚ü≤ Limpar filtros</button>
      </div>

      <div class="filtros-grid">
        <div>
          <div class="filtro-label">CS</div>
          <input id="fCs" placeholder="ex: 445119" />
        </div>
        <div>
          <div class="filtro-label">Nome Completo</div>
          <input id="fNome" placeholder="digite parte do nome" />
        </div>
        <div>
          <div class="filtro-label">Cargo</div>
          <input id="fCargo" placeholder="ex: Coordenador" />
        </div>
        <div>
          <div class="filtro-label">Cipia</div>
          <input id="fCipia" placeholder="ex: Central Serras" />
        </div>
        <div>
          <div class="filtro-label">Coordena√ß√£o</div>
          <input id="fCoord" placeholder="ex: Planejamento" />
        </div>
        <div>
          <div class="filtro-label">Treinamento</div>
          <input id="fTreino" placeholder="ex: Primeiros Socorros" />
        </div>
        <div>
          <div class="filtro-label">Forma√ß√£o</div>
          <input id="fFormacao" placeholder="dd/mm/aaaa ou /2025" />
        </div>
        <div>
          <div class="filtro-label">Vencimento</div>
          <input id="fVencimento" placeholder="dd/mm/aaaa ou /2026" />
        </div>
        <div>
          <div class="filtro-label">Status</div>
          <select id="fStatus">
            <option value="">(todos)</option>
            <option value="valido">V√°lido</option>
            <option value="a-vencer">√Ä Vencer</option>
            <option value="vencido">Vencido</option>
            <option value="nao-concluido">N√£o Conclu√≠do</option>
            <option value="teste">Teste</option>
          </select>
        </div>
      </div>
    </section>

    <section>
      <div id="mural"></div>
      <p id="vazio" class="empty" style="display:none">
        Nenhum registro encontrado para os filtros selecionados.
      </p>
    </section>

  </main>

<script>
/* ===================== PASTA DE FOTOS ===================== */
const BASE_FOTOS =
  "https://rumolog.sharepoint.com/sites/AdernciaaoPDMInfraePonte/Documentos%20Compartilhados/0.%20MALHA%20SUL/02.%20PLANEJAMENTO/04.%20PLANO%20DE%20MANUTEN%C3%87%C3%83O/06.%20BI%27s/3.%20T.I/DOC%20-%20PORTAL%20INFRA/Fotos%20Aniversariantes";

const LOGO_RUMO = BASE_FOTOS + "/logo_rumo.png"; // ajuste se precisar
document.getElementById("logoRumo").src = LOGO_RUMO;

/* ========================= DADOS ========================= */
/*
  IMPORTANTE:
  - Agora o layout inclui "coordenacao" (Coordena√ß√£o).
  - Voc√™ pode colar aqui seu TREINOS_RAW completo.
*/
const TREINOS_RAW = [

  {
    cs: "383679",
    nome: "Jennifer Desiree M Cavalheiro C√∫nico",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "04/01/2023",
    vencimento: "04/01/2024",
    status: "Vencido",
    coordenacao: "Engenharia OAE's"
  },
  {
    cs: "383679",
    nome: "Jennifer Desiree M Cavalheiro C√∫nico",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "14/02/2024",
    vencimento: "13/02/2025",
    status: "Vencido",
    coordenacao: "Engenharia OAE's"
  },
  {
    cs: "383679",
    nome: "Jennifer Desiree M Cavalheiro C√∫nico",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "14/02/2024",
    vencimento: "13/02/2025",
    status: "Vencido",
    coordenacao: "Engenharia OAE's"
  },
  {
    cs: "383679",
    nome: "Jennifer Desiree M Cavalheiro C√∫nico",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "19/06/2024",
    vencimento: "19/06/2025",
    status: "Vencido",
    coordenacao: "Engenharia OAE's"
  },
  {
    cs: "383679",
    nome: "Jennifer Desiree M Cavalheiro C√∫nico",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "03/03/2025",
    vencimento: "03/03/2026",
    status: "V√°lido",
    coordenacao: "Engenharia OAE's"
  },

  {
    cs: "445119",
    nome: "Livia Cristina Guimaraes Oliveira",
    cargo: "T√©cnico Administrativo Sr",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "27/10/2025",
    vencimento: "27/10/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "445119",
    nome: "Livia Cristina Guimaraes Oliveira",
    cargo: "T√©cnico Administrativo Sr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "24/09/2025",
    vencimento: "24/09/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "445119",
    nome: "Livia Cristina Guimaraes Oliveira",
    cargo: "T√©cnico Administrativo Sr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "24/09/2025",
    vencimento: "24/09/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "445119",
    nome: "Livia Cristina Guimaraes Oliveira",
    cargo: "T√©cnico Administrativo Sr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "",
    vencimento: "",
    status: "N√£o Conclu√≠do",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },

  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "20/10/2025",
    vencimento: "20/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "13/08/2025",
    vencimento: "13/08/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "12/05/2025",
    vencimento: "12/05/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/01/2025",
    vencimento: "15/01/2027",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "13/01/2025",
    vencimento: "13/01/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "06/01/2025",
    vencimento: "06/01/2026",
    status: "Vencido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "407501",
    nome: "Luciano Frederico Stelle",
    cargo: "Analista de Opera√ß√£o Sr",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "06/01/2025",
    vencimento: "06/01/2026",
    status: "Vencido",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "16/06/2025",
    vencimento: "16/06/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "7 Regras da Vida",
    formacao: "07/05/2025",
    vencimento: "07/05/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "RO M√≥d. III",
    formacao: "07/05/2025",
    vencimento: "07/05/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "20/02/2025",
    vencimento: "20/02/2027",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "24/01/2025",
    vencimento: "24/01/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "24/01/2025",
    vencimento: "24/01/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "261095",
    nome: "Luis Felipe Martinelli Martins",
    cargo: "Coordenador de Planejamento",
    cipia: "RS",
    treinamento: "Primeiros Socorros",
    formacao: "07/10/2024",
    vencimento: "07/10/2025",
    status: "Vencido",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },

  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "08/07/2025",
    vencimento: "08/07/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "16/06/2025",
    vencimento: "16/06/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "12/05/2025",
    vencimento: "12/05/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "12/05/2025",
    vencimento: "12/05/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "23/01/2025",
    vencimento: "23/01/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "263851",
    nome: "Matias Alejandro Aduco",
    cargo: "Analista de Planejamento Sr",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/01/2025",
    vencimento: "15/01/2027",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },

  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "18/07/2025",
    vencimento: "18/07/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "26/03/2025",
    vencimento: "26/03/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/01/2025",
    vencimento: "15/01/2027",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "02/09/2024",
    vencimento: "02/09/2025",
    status: "Vencido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "02/09/2024",
    vencimento: "02/09/2025",
    status: "Vencido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "331946",
    nome: "Nicholas Matheus Bachaus Stein",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "02/09/2024",
    vencimento: "02/09/2025",
    status: "Vencido",
    coordenacao: "Engenharia Infraestrutura"
  },

  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Utiliza√ß√£o Adequada dos EPI‚Äôs",
    formacao: "22/10/2025",
    vencimento: "22/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "09/07/2025",
    vencimento: "09/07/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "09/07/2025",
    vencimento: "09/07/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "02/06/2025",
    vencimento: "02/06/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "23/05/2025",
    vencimento: "23/05/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "17/03/2025",
    vencimento: "17/03/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "17/03/2025",
    vencimento: "17/03/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "279728",
    nome: "Rafael Robert Nahra",
    cargo: "Coordenador de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "09/03/2025",
    vencimento: "09/03/2027",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Norte"
  },

  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "22/10/2025",
    vencimento: "22/10/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "19/09/2025",
    vencimento: "19/09/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "16/07/2025",
    vencimento: "16/07/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "10/06/2025",
    vencimento: "10/06/2026",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/01/2025",
    vencimento: "15/01/2027",
    status: "V√°lido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },
  {
    cs: "268207",
    nome: "Ricardo Assumpcao Junior",
    cargo: "Coordenador de Planejamento",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "07/11/2024",
    vencimento: "07/11/2025",
    status: "Vencido",
    coordenacao: "Institucional e Faixa de Dom√≠nio"
  },

  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "21/01/2025",
    vencimento: "21/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Utiliza√ß√£o Adequada dos EPI‚Äôs",
    formacao: "16/01/2025",
    vencimento: "16/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "15/01/2025",
    vencimento: "15/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "15/01/2025",
    vencimento: "15/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "15/01/2025",
    vencimento: "15/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "15/01/2025",
    vencimento: "15/01/2026",
    status: "V√°lido",
    coordenacao: "Gerente"
  },
  {
    cs: "385519",
    nome: "Ricardo Gasparino Ribas",
    cargo: "Gerente de Planejamento",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "23/09/2024",
    vencimento: "23/09/2025",
    status: "Vencido",
    coordenacao: "Gerente"
  },

  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "03/10/2025",
    vencimento: "03/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "03/10/2025",
    vencimento: "03/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "03/10/2025",
    vencimento: "03/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "31/03/2025",
    vencimento: "31/03/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/01/2025",
    vencimento: "15/01/2027",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "258087",
    nome: "Roberto Benedito Antunes",
    cargo: "Especialista de Opera√ß√£o Jr",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "10/01/2025",
    vencimento: "10/01/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  {
    cs: "437413",
    nome: "Sergio Alves Neves Junior",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "13/10/2025",
    vencimento: "13/10/2026",
    status: "V√°lido",
    coordenacao: "Engenharia infraestrutura"
  },
  {
    cs: "437413",
    nome: "Sergio Alves Neves Junior",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "15/08/2025",
    vencimento: "15/08/2027",
    status: "V√°lido",
    coordenacao: "Engenharia infraestrutura"
  },
  {
    cs: "437413",
    nome: "Sergio Alves Neves Junior",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "15/05/2025",
    vencimento: "15/05/2026",
    status: "V√°lido",
    coordenacao: "Engenharia infraestrutura"
  },
  {
    cs: "437413",
    nome: "Sergio Alves Neves Junior",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "13/05/2025",
    vencimento: "13/05/2026",
    status: "V√°lido",
    coordenacao: "Engenharia infraestrutura"
  },
  {
    cs: "437413",
    nome: "Sergio Alves Neves Junior",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "13/05/2025",
    vencimento: "13/05/2026",
    status: "V√°lido",
    coordenacao: "Engenharia infraestrutura"
  },

  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "09/10/2025",
    vencimento: "09/10/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "31/07/2025",
    vencimento: "31/07/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "24/07/2025",
    vencimento: "24/07/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "24/07/2025",
    vencimento: "24/07/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "16/12/2024",
    vencimento: "16/12/2025",
    status: "Vencido",
    coordenacao: "Planejamento"
  },
  {
    cs: "407664",
    nome: "Thalita Cristina Santos Jacojaco",
    cargo: "Analista de Planejamento Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "16/12/2024",
    vencimento: "16/12/2025",
    status: "Vencido",
    coordenacao: "Planejamento"
  },

  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "17/06/2025",
    vencimento: "17/06/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "30/04/2025",
    vencimento: "30/04/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "06/03/2025",
    vencimento: "06/03/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "23/01/2025",
    vencimento: "23/01/2026",
    status: "Vencido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "23/01/2025",
    vencimento: "23/01/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "17/12/2024",
    vencimento: "17/12/2025",
    status: "Vencido",
    coordenacao: "Planejamento"
  },
  {
    cs: "330762",
    nome: "Victor Hugo Miranda Oliveira",
    cargo: "Analista de Planejamento Jr",
    cipia: "Central Serras",
    treinamento: "Utiliza√ß√£o Adequada dos EPI‚Äôs",
    formacao: "21/11/2024",
    vencimento: "21/11/2025",
    status: "Vencido",
    coordenacao: "Planejamento"
  },

  {
    cs: "434612",
    nome: "Vitor Cerqueira Dos Santos",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "28/04/2025",
    vencimento: "28/04/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "434612",
    nome: "Vitor Cerqueira Dos Santos",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "27/04/2025",
    vencimento: "27/04/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "434612",
    nome: "Vitor Cerqueira Dos Santos",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "27/04/2025",
    vencimento: "27/04/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },
  {
    cs: "434612",
    nome: "Vitor Cerqueira Dos Santos",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "27/04/2025",
    vencimento: "27/04/2026",
    status: "V√°lido",
    coordenacao: "Planejamento"
  },

  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "22/10/2025",
    vencimento: "22/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "22/10/2025",
    vencimento: "22/10/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "22/09/2025",
    vencimento: "22/09/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "09/09/2025",
    vencimento: "09/09/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "04/09/2025",
    vencimento: "04/09/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444209",
    nome: "Vitor Hugo Tonini",
    cargo: "Analista Administrativo Jr",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "04/09/2025",
    vencimento: "04/09/2026",
    status: "V√°lido",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  {
    cs: "446899",
    nome: "Vitor Emanoel Gon√ßalves Pereira",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "28/11/2025",
    vencimento: "28/11/2027",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "446899",
    nome: "Vitor Emanoel Gon√ßalves Pereira",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "19/11/2025",
    vencimento: "19/11/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "446899",
    nome: "Vitor Emanoel Gon√ßalves Pereira",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "19/11/2025",
    vencimento: "19/11/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "446899",
    nome: "Vitor Emanoel Gon√ßalves Pereira",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "19/11/2025",
    vencimento: "19/11/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "446899",
    nome: "Vitor Emanoel Gon√ßalves Pereira",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. II",
    formacao: "19/11/2025",
    vencimento: "19/11/2026",
    status: "V√°lido",
    coordenacao: "Engenharia Infraestrutura"
  },

  {
    cs: "448517",
    nome: "Pablo Henrique Amarante",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "448517",
    nome: "Pablo Henrique Amarante",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "448517",
    nome: "Pablo Henrique Amarante",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "448517",
    nome: "Pablo Henrique Amarante",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Engenharia Infraestrutura"
  },
  {
    cs: "448517",
    nome: "Pablo Henrique Amarante",
    cargo: "Analista de Planejamento Pl",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. II",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Engenharia Infraestrutura"
  },

  // Vagner Henrique Dos Santos (sem CS)
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Vagner Henrique Dos Santos",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },

  // Walter Kegler Filho (sem CS)
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },
  {
    cs: "",
    nome: "Walter Kegler Filho",
    cargo: "Fiscal",
    cipia: "Norte PR + Ramais",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Norte"
  },

  // Jose Roberto Miranda (sem CS)
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jose Roberto Miranda",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  // Luis Henrique Freire Damasceno Nascimento
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "448859",
    nome: "Luis Henrique Freire Damasceno Nascimento",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  // Jo√£o Paulo da Silva Garcia (sem CS)
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "",
    nome: "Jo√£o Paulo da Silva Garcia",
    cargo: "Fiscal",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  // Thaina de Fatima Rosa Lopes
  {
    cs: "444075",
    nome: "Thaina de Fatima Rosa Lopes",
    cargo: "Analista Administrativo Jr",
    cipia: "Central Serras",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444075",
    nome: "Thaina de Fatima Rosa Lopes",
    cargo: "Analista Administrativo Jr",
    cipia: "Central Serras",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444075",
    nome: "Thaina de Fatima Rosa Lopes",
    cargo: "Analista Administrativo Jr",
    cipia: "Central Serras",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444075",
    nome: "Thaina de Fatima Rosa Lopes",
    cargo: "Analista Administrativo Jr",
    cipia: "Central Serras",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },
  {
    cs: "444075",
    nome: "Thaina de Fatima Rosa Lopes",
    cargo: "Analista Administrativo Jr",
    cipia: "Central Serras",
    treinamento: "RO M√≥d. II",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Central Serras"
  },

  // Diorge Roni Garcia Viana (sem CS)
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Diorge Roni Garcia Viana",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },

  // Lucas Camargo Motta (sem CS)
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Lucas Camargo Motta",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },

  // Eduandro Lutz (sem CS)
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "7 Regras da Vida",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Pol√≠tica sobre Uso de √Ålcool e Drogas",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Primeiros Socorros",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "NR 35 - Trabalho em Altura",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Dire√ß√£o Segura -  Te√≥rico",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "Integra√ß√£o de Sa√∫de e Seguran√ßa",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  },
  {
    cs: "",
    nome: "Eduandro Lutz",
    cargo: "Fiscal",
    cipia: "RS",
    treinamento: "RO M√≥d. III",
    formacao: "xx/xx/xxxx",
    vencimento: "xx/xx/xxxx",
    status: "Teste",
    coordenacao: "Execu√ß√£o Rio Grande do Sul"
  }
];


/* ==================== FUN√á√ïES AUXILIARES ==================== */
function semAcento(s){
  return String(s||"").normalize("NFD").replace(/\p{Diacritic}/gu,"");
}
function trim1(s){
  return String(s||"").trim().replace(/\s+/g," ");
}
function normKey(s){
  // normaliza "√Å Vencer", "A Vencer", "√Ä Vencer" -> a-vencer etc.
  const x = semAcento(String(s||"")).toLowerCase().trim();
  if(!x) return "";
  if(x.includes("nao") && x.includes("concl")) return "nao-concluido";
  if(x.includes("vencido")) return "vencido";
  if(x.includes("vencer")) return "a-vencer";
  if(x.includes("valido")) return "valido";
  if(x.includes("teste")) return "teste";
  return x.replace(/\s+/g,"-");
}
function normLabelFromKey(key){
  switch(key){
    case "valido": return "V√°lido";
    case "a-vencer": return "√Ä Vencer";
    case "vencido": return "Vencido";
    case "nao-concluido": return "N√£o Conclu√≠do";
    case "teste": return "Teste";
    default: return key;
  }
}

/* FOTO ‚Äì mesma l√≥gica */
const EXTS = [".jpeg",".jpg",".png",".webp"];
const ICON_DEFAULT = "https://cdn-icons-png.flaticon.com/512/847/847969.png";

function variantesDeBase(nome){
  const withAccents = trim1(nome);
  const noAccents   = trim1(semAcento(nome));
  const lowers = [withAccents.toLowerCase(), noAccents.toLowerCase()];
  const set = new Set();
  for (const b of lowers){
    set.add(b);
    set.add(b.replace(/\s+/g,'.'));
    set.add(b.replace(/\s+/g,'-'));
    set.add(b.replace(/\s+/g,''));
  }
  return Array.from(set);
}

function montarURLs(filename){
  const pasta = BASE_FOTOS.replace(/\/$/,'');
  const full = `${pasta}/${encodeURIComponent(filename)}`;
  const down = `https://rumolog.sharepoint.com/_layouts/15/download.aspx?SourceUrl=${encodeURIComponent(full)}`;
  return [full, down];
}

function construirListaCandidatosTreino(t){
  const urls = [];
  for(const v of variantesDeBase(t.nome||"")){
    for(const e of EXTS) urls.push(...montarURLs(v+e));
  }
  return urls.map((u,i)=> u + (u.includes('?') ? '&' : '?') + 'v=' + (i%5));
}

function avatarIniciais(nome){
  const ini=(nome||"").split(/\s+/).filter(Boolean)
    .map(w=>w[0].toUpperCase()).slice(0,3).join('');
  const svg = `
  <svg xmlns="http://www.w3.org/2000/svg" width="110" height="110">
    <defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0%" stop-color="#6b2fbf"/><stop offset="100%" stop-color="#a855f7"/>
    </linearGradient></defs>
    <rect width="110" height="110" rx="55" fill="url(#g)"/>
    <text x="50%" y="55%" text-anchor="middle" font-family="Segoe UI, Arial"
          font-size="40" fill="#fff" font-weight="700">${ini}</text>
  </svg>`;
  return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg);
}

function getFotoUrlTreino(t){
  const cand = construirListaCandidatosTreino(t);
  cand.push(avatarIniciais(t.nome));
  cand.push(ICON_DEFAULT);
  t.__fotos = cand.slice(1);
  return cand[0];
}

function aplicarOnError(img,t){
  img.onerror=function(){
    const fila=t.__fotos||[];
    while(fila.length){
      const prox=fila.shift();
      if(prox && prox!==this.src){ this.src=prox; return; }
    }
    this.onerror=null;
  };
}

/* Datas dd/mm/aaaa ‚Üí objeto (ignora "xx/xx/xxxx") */
function parseDataBr(str){
  const s = String(str||"").trim();
  if(!s) return {dia:NaN, mes:NaN, ano:NaN, date:null};
  if(/x/i.test(s)) return {dia:NaN, mes:NaN, ano:NaN, date:null};
  if(!/^\d{2}\/\d{2}\/\d{4}$/.test(s)) return {dia:NaN, mes:NaN, ano:NaN, date:null};

  const [d,m,a] = s.split("/").map(x=>parseInt(x,10));
  if(!d || !m || !a) return {dia:NaN, mes:NaN, ano:NaN, date:null};
  const dt = new Date(a, m-1, d);

  // valida realmente a data (ex: 31/02/2025)
  if(dt.getFullYear() !== a || (dt.getMonth()+1) !== m || dt.getDate() !== d){
    return {dia:NaN, mes:NaN, ano:NaN, date:null};
  }
  return {dia:d, mes:m, ano:a, date:dt};
}

/* STATUS:
   - Se vier status preenchido na planilha: usa ele (normalizado).
   - Sen√£o: calcula pelo vencimento:
       - sem data -> N√£o Conclu√≠do
       - vencimento < hoje -> Vencido
       - vencimento <= 30 dias -> √Ä Vencer
       - sen√£o -> V√°lido
*/
function calcularStatusFinal(t, vObj, hojeBase){
  const keyFromSheet = normKey(t.status);
  if(keyFromSheet) return { key: keyFromSheet, label: normLabelFromKey(keyFromSheet) };

  const vDate = vObj.date;
  if(!vDate) return { key:"nao-concluido", label:"N√£o Conclu√≠do" };

  const msDia = 24*60*60*1000;
  const vBase = new Date(vDate.getFullYear(), vDate.getMonth(), vDate.getDate());
  const diffDias = Math.round((vBase - hojeBase)/msDia);

  if(diffDias < 0) return { key:"vencido", label:"Vencido" };
  if(diffDias <= 30) return { key:"a-vencer", label:"√Ä Vencer" };
  return { key:"valido", label:"V√°lido" };
}

function statusClass(key){
  switch(key){
    case "valido": return "st-valido";
    case "a-vencer": return "st-a-vencer";
    case "vencido": return "st-vencido";
    case "nao-concluido": return "st-nao-concluido";
    case "teste": return "st-teste";
    default: return "";
  }
}

/* =============== RENDERIZA√á√ÉO ================= */
function renderTreinos(){
  const mural=document.getElementById("mural");
  const vazio=document.getElementById("vazio");
  mural.innerHTML="";

  const hoje=new Date();
  const hojeBase = new Date(hoje.getFullYear(), hoje.getMonth(), hoje.getDate());
  const diaHoje=hojeBase.getDate(), mesHoje=hojeBase.getMonth()+1, anoHoje=hojeBase.getFullYear();

  const fCs = document.getElementById("fCs").value.trim();
  const fNome = semAcento(document.getElementById("fNome").value.toLowerCase());
  const fCargo = semAcento(document.getElementById("fCargo").value.toLowerCase());
  const fCipia = semAcento(document.getElementById("fCipia").value.toLowerCase());
  const fCoord = semAcento(document.getElementById("fCoord").value.toLowerCase());
  const fTreino = semAcento(document.getElementById("fTreino").value.toLowerCase());
  const fFormacao = document.getElementById("fFormacao").value.trim();
  const fVencimento = document.getElementById("fVencimento").value.trim();
  const fStatus = document.getElementById("fStatus").value;

  const lista = TREINOS_RAW
    .map(t => {
      const _v = parseDataBr(t.vencimento);
      const _f = parseDataBr(t.formacao);
      const st = calcularStatusFinal(t, _v, hojeBase);
      return {
        ...t,
        _v, _f,
        _statusKey: st.key,
        _statusLabel: st.label
      };
    })
    .filter(t => {
      if(fCs && !String(t.cs||"").includes(fCs)) return false;
      if(fNome && !semAcento(t.nome||"").toLowerCase().includes(fNome)) return false;
      if(fCargo && !semAcento(t.cargo||"").toLowerCase().includes(fCargo)) return false;
      if(fCipia && !semAcento(t.cipia||"").toLowerCase().includes(fCipia)) return false;
      if(fCoord && !semAcento(t.coordenacao||"").toLowerCase().includes(fCoord)) return false;
      if(fTreino && !semAcento(t.treinamento||"").toLowerCase().includes(fTreino)) return false;
      if(fFormacao && !(String(t.formacao||"").includes(fFormacao))) return false;
      if(fVencimento && !(String(t.vencimento||"").includes(fVencimento))) return false;
      if(fStatus && t._statusKey !== fStatus) return false;
      return true;
    })
    .sort((a,b)=>{
      // ordena por vencimento v√°lido primeiro; depois nome; depois treinamento
      const da=a._v.date, db=b._v.date;
      if(da && db) return (da - db) || semAcento(a.nome).localeCompare(semAcento(b.nome)) || semAcento(a.treinamento).localeCompare(semAcento(b.treinamento));
      if(da && !db) return -1;
      if(!da && db) return 1;
      return semAcento(a.nome).localeCompare(semAcento(b.nome)) || semAcento(a.treinamento).localeCompare(semAcento(b.treinamento));
    });

  if(!lista.length){
    vazio.style.display="block";
    return;
  }
  vazio.style.display="none";

  for(const t of lista){
    const card=document.createElement("div");
    const v = t._v;
    const ehHoje = v.dia===diaHoje && v.mes===mesHoje && v.ano===anoHoje;
    card.className="card" + (ehHoje?" card-hoje":"");

    if(ehHoje){
      const pill=document.createElement("div");
      pill.className="pill-hoje";
      pill.textContent="Vence hoje";
      card.appendChild(pill);
    }

    const img=document.createElement("img");
    img.alt=t.nome;
    img.loading="lazy";
    img.decoding="async";
    img.src=getFotoUrlTreino(t);
    aplicarOnError(img,t);

    const info=document.createElement("div");
    info.className="info";

    const linhaTop=document.createElement("div");
    linhaTop.className="linha-top";

    const nomeEl=document.createElement("p");
    nomeEl.className="nome";
    nomeEl.textContent=t.nome || "(sem nome)";
    linhaTop.appendChild(nomeEl);

    if(t.cs){
      const cs=document.createElement("span");
      cs.className="cs-tag";
      cs.textContent="CS " + t.cs;
      linhaTop.appendChild(cs);
    }

    const linhaSub=document.createElement("p");
    linhaSub.className="linha-sub";

    const partes = [];
    if(t.cargo) partes.push(t.cargo);
    if(t.cipia) partes.push(t.cipia);
    if(t.coordenacao) partes.push(t.coordenacao);
    linhaSub.textContent = partes.join(" ‚Ä¢ ");

    const treino=document.createElement("p");
    treino.className="treino";
    treino.textContent=t.treinamento || "";

    const datas=document.createElement("p");
    datas.className="datas";
    datas.textContent =
      "Forma√ß√£o: " + (t.formacao || "--/--/----") +
      " ¬∑ Vencimento: " + (t.vencimento || "--/--/----");

    info.appendChild(linhaTop);
    info.appendChild(linhaSub);
    info.appendChild(treino);
    info.appendChild(datas);

    if(t._statusLabel){
      const st=document.createElement("span");
      st.className="status-badge " + statusClass(t._statusKey);
      st.textContent=t._statusLabel;
      info.appendChild(st);
    }

    card.appendChild(img);
    card.appendChild(info);
    mural.appendChild(card);
  }
}

/* Eventos de filtro ‚Äì aplica na hora (com debounce leve) */
let debounceId;
function onFilterChange(){
  clearTimeout(debounceId);
  debounceId=setTimeout(renderTreinos, 120);
}
["fCs","fNome","fCargo","fCipia","fCoord","fTreino","fFormacao","fVencimento","fStatus"]
  .forEach(id=>{
    const el = document.getElementById(id);
    el.addEventListener(id==="fStatus" ? "change" : "input", onFilterChange);
  });

/* Bot√£o LIMPAR FILTROS */
document.getElementById("btnLimpar").addEventListener("click", () => {
  ["fCs","fNome","fCargo","fCipia","fCoord","fTreino","fFormacao","fVencimento"].forEach(id=>{
    document.getElementById(id).value="";
  });
  document.getElementById("fStatus").value="";
  renderTreinos();
});

renderTreinos();
</script>

</body>
</html>
